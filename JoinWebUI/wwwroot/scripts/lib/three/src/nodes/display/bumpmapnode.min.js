/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.170.0/src/nodes/display/BumpMapNode.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import TempNode from"../core/TempNode.js";import{uv}from"../accessors/UV.js";import{normalView}from"../accessors/Normal.js";import{positionView}from"../accessors/Position.js";import{faceDirection}from"./FrontFacingNode.js";import{Fn,nodeProxy,float,vec2}from"../tsl/TSLBase.js";const dHdxy_fwd=Fn((({textureNode:o,bumpScale:e})=>{const r=e=>o.cache().context({getUV:o=>e(o.uvNode||uv()),forceUVContext:!0}),t=float(r((o=>o)));return vec2(float(r((o=>o.add(o.dFdx())))).sub(t),float(r((o=>o.add(o.dFdy())))).sub(t)).mul(e)})),perturbNormalArb=Fn((o=>{const{surf_pos:e,surf_norm:r,dHdxy:t}=o,s=e.dFdx().normalize(),d=r,u=e.dFdy().normalize().cross(d),m=d.cross(s),a=s.dot(u).mul(faceDirection),c=a.sign().mul(t.x.mul(u).add(t.y.mul(m)));return a.abs().mul(r).sub(c).normalize()}));class BumpMapNode extends TempNode{static get type(){return"BumpMapNode"}constructor(o,e=null){super("vec3"),this.textureNode=o,this.scaleNode=e}setup(){const o=null!==this.scaleNode?this.scaleNode:1,e=dHdxy_fwd({textureNode:this.textureNode,bumpScale:o});return perturbNormalArb({surf_pos:positionView,surf_norm:normalView,dHdxy:e})}}export default BumpMapNode;export const bumpMap=nodeProxy(BumpMapNode);
//# sourceMappingURL=/sm/0af1a897f135299e9cbb9961064d39a868bc2b3fec80d2e6387b6ce5e21a5322.map