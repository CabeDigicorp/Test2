/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.170.0/src/nodes/accessors/StorageBufferNode.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import BufferNode from"./BufferNode.js";import{bufferAttribute}from"./BufferAttributeNode.js";import{nodeObject,varying}from"../tsl/TSLBase.js";import{storageElement}from"../utils/StorageArrayElementNode.js";import{GPUBufferBindingType}from"../../renderers/webgpu/utils/WebGPUConstants.js";class StorageBufferNode extends BufferNode{static get type(){return"StorageBufferNode"}constructor(t,e,r=0){super(t,e,r),this.isStorageBufferNode=!0,this.access=GPUBufferBindingType.Storage,this.isAtomic=!1,this.bufferObject=!1,this.bufferCount=r,this._attribute=null,this._varying=null,this.global=!0,!0!==t.isStorageBufferAttribute&&!0!==t.isStorageInstancedBufferAttribute&&(t.isInstancedBufferAttribute?t.isStorageInstancedBufferAttribute=!0:t.isStorageBufferAttribute=!0)}getHash(t){if(0===this.bufferCount){let e=t.globalCache.getData(this.value);return void 0===e&&(e={node:this},t.globalCache.setData(this.value,e)),e.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(t){return storageElement(this,t)}setBufferObject(t){return this.bufferObject=t,this}setAccess(t){return this.access=t,this}toReadOnly(){return this.setAccess(GPUBufferBindingType.ReadOnlyStorage)}setAtomic(t){return this.isAtomic=t,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return null===this._attribute&&(this._attribute=bufferAttribute(this.value),this._varying=varying(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(t){if(t.isAvailable("storageBuffer")||t.isAvailable("indirectStorageBuffer"))return super.getNodeType(t);const{attribute:e}=this.getAttributeData();return e.getNodeType(t)}generate(t){if(t.isAvailable("storageBuffer")||t.isAvailable("indirectStorageBuffer"))return super.generate(t);const{attribute:e,varying:r}=this.getAttributeData(),i=r.build(t);return t.registerTransform(i,e),i}}export default StorageBufferNode;export const storage=(t,e,r)=>nodeObject(new StorageBufferNode(t,e,r));export const storageObject=(t,e,r)=>nodeObject(new StorageBufferNode(t,e,r).setBufferObject(!0));
//# sourceMappingURL=/sm/e928c0f08dc75431a0375c92620601fcdb32297526ba039ab2fbc60164b78cc8.map