/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.170.0/src/nodes/accessors/Normal.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{attribute}from"../core/AttributeNode.js";import{cameraViewMatrix}from"./Camera.js";import{modelNormalMatrix,modelWorldMatrix}from"./ModelNode.js";import{mat3,vec3}from"../tsl/TSLBase.js";import{positionView}from"./Position.js";import{Fn,varying}from"../tsl/TSLBase.js";import{faceDirection}from"../display/FrontFacingNode.js";export const normalGeometry=attribute("normal","vec3");export const normalLocal=Fn((o=>!1===o.geometry.hasAttribute("normal")?(console.warn('TSL.NormalNode: Vertex attribute "normal" not found on geometry.'),vec3(0,1,0)):normalGeometry),"vec3").once()().toVar("normalLocal");export const normalFlat=positionView.dFdx().cross(positionView.dFdy()).normalize().toVar("normalFlat");export const normalView=Fn((o=>{let r;return r=!0===o.material.flatShading?normalFlat:varying(transformNormalToView(normalLocal),"v_normalView").normalize(),r}),"vec3").once()().toVar("normalView");export const normalWorld=varying(normalView.transformDirection(cameraViewMatrix),"v_normalWorld").normalize().toVar("normalWorld");export const transformedNormalView=Fn((o=>o.context.setupNormal()),"vec3").once()().mul(faceDirection).toVar("transformedNormalView");export const transformedNormalWorld=transformedNormalView.transformDirection(cameraViewMatrix).toVar("transformedNormalWorld");export const transformedClearcoatNormalView=Fn((o=>o.context.setupClearcoatNormal()),"vec3").once()().mul(faceDirection).toVar("transformedClearcoatNormalView");export const transformNormal=Fn((([o,r=modelWorldMatrix])=>{const t=mat3(r),e=o.div(vec3(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(e).xyz}));export const transformNormalToView=Fn((([o],r)=>{const t=r.renderer.nodes.modelNormalViewMatrix;if(null!==t)return t.transformDirection(o);const e=modelNormalMatrix.mul(o);return cameraViewMatrix.transformDirection(e)}));
//# sourceMappingURL=/sm/89fbd0773bb9f2bacbaa4afe3f5e54325d58f4b1bc398f662cee49fbb4e3e26e.map