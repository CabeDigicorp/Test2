/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.170.0/src/materials/nodes/SpriteNodeMaterial.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import NodeMaterial from"./NodeMaterial.js";import{cameraProjectionMatrix}from"../../nodes/accessors/Camera.js";import{materialRotation}from"../../nodes/accessors/MaterialNode.js";import{modelViewMatrix,modelWorldMatrix}from"../../nodes/accessors/ModelNode.js";import{positionLocal}from"../../nodes/accessors/Position.js";import{rotate}from"../../nodes/utils/RotateNode.js";import{float,vec2,vec3,vec4}from"../../nodes/tsl/TSLBase.js";import{SpriteMaterial}from"../SpriteMaterial.js";import{reference}from"../../nodes/accessors/ReferenceBaseNode.js";const _defaultValues=new SpriteMaterial;class SpriteNodeMaterial extends NodeMaterial{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this.lights=!1,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.setDefaultValues(_defaultValues),this.setValues(e)}setupPosition({object:e,camera:t,context:o}){const i=this.sizeAttenuation,{positionNode:s,rotationNode:r,scaleNode:a}=this,n=positionLocal;let l=modelViewMatrix.mul(vec3(s||0)),c=vec2(modelWorldMatrix[0].xyz.length(),modelWorldMatrix[1].xyz.length());if(null!==a&&(c=c.mul(a)),!i)if(t.isPerspectiveCamera)c=c.mul(l.z.negate());else{const e=float(2).div(cameraProjectionMatrix.element(1).element(1));c=c.mul(e.mul(2))}let d=n.xy;if(e.center&&!0===e.center.isVector2){const e=reference("center","vec2");d=d.sub(e.sub(.5))}d=d.mul(c);const u=float(r||materialRotation),m=rotate(d,u);l=vec4(l.xy.add(m),l.zw);const p=cameraProjectionMatrix.mul(l);return o.vertex=n,p}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}export default SpriteNodeMaterial;
//# sourceMappingURL=/sm/be7d43acdbc82b837ddb8d2c62d868d7f855ad471e8d4f6316e58794ecac4639.map