/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.170.0/examples/jsm/postprocessing/BokehPass.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Color,HalfFloatType,MeshDepthMaterial,NearestFilter,NoBlending,RGBADepthPacking,ShaderMaterial,UniformsUtils,WebGLRenderTarget}from"three";import{Pass,FullScreenQuad}from"./Pass.js";import{BokehShader}from"../shaders/BokehShader.js";class BokehPass extends Pass{constructor(e,r,t){super(),this.scene=e,this.camera=r;const a=void 0!==t.focus?t.focus:1,s=void 0!==t.aperture?t.aperture:.025,i=void 0!==t.maxblur?t.maxblur:1;this.renderTargetDepth=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new MeshDepthMaterial,this.materialDepth.depthPacking=RGBADepthPacking,this.materialDepth.blending=NoBlending;const l=BokehShader,h=UniformsUtils.clone(l.uniforms);h.tDepth.value=this.renderTargetDepth.texture,h.focus.value=a,h.aspect.value=r.aspect,h.aperture.value=s,h.maxblur.value=i,h.nearClip.value=r.near,h.farClip.value=r.far,this.materialBokeh=new ShaderMaterial({defines:Object.assign({},l.defines),uniforms:h,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),this.uniforms=h,this.fsQuad=new FullScreenQuad(this.materialBokeh),this._oldClearColor=new Color}render(e,r,t){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const a=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=t.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(a),e.autoClear=s}setSize(e,r){this.materialBokeh.uniforms.aspect.value=e/r,this.renderTargetDepth.setSize(e,r)}dispose(){this.renderTargetDepth.dispose(),this.materialDepth.dispose(),this.materialBokeh.dispose(),this.fsQuad.dispose()}}export{BokehPass};
//# sourceMappingURL=/sm/515a2f4754eec5a43fa91574fde623823445a40d209535aedbd68abd661d2c9c.map