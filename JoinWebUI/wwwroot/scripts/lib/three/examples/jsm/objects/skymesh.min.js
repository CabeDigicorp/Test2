/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.170.0/examples/jsm/objects/SkyMesh.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{BackSide,BoxGeometry,Mesh,Vector3}from"three";import{Fn,NodeMaterial,float,vec3,acos,add,mul,clamp,cos,dot,exp,max,mix,modelViewProjection,normalize,positionWorld,pow,smoothstep,sub,varying,varyingProperty,vec4,uniform,cameraPosition}from"three/tsl";class SkyMesh extends Mesh{constructor(){const o=new NodeMaterial;super(new BoxGeometry(1,1,1),o),this.turbidity=uniform(2),this.rayleigh=uniform(1),this.mieCoefficient=uniform(.005),this.mieDirectionalG=uniform(.8),this.sunPosition=uniform(new Vector3),this.upUniform=uniform(new Vector3(0,1,0)),this.isSky=!0;const t=Fn((()=>{const o=float(2.718281828459045),t=vec3(5804542996261093e-21,13562911419845635e-21,30265902468824876e-21),e=vec3(183999185144339.78,277980239196605.28,407904795438610.94),i=float(1.6110731556870734),a=float(1.5),s=float(1e3),l=normalize(this.sunPosition);varyingProperty("vec3","vSunDirection").assign(l);const n=dot(l,this.upUniform),r=clamp(n,-1,1),m=s.mul(max(0,float(1).sub(pow(o,i.sub(acos(r)).div(a).negate()))));varyingProperty("float","vSunE").assign(m);const u=float(1).sub(clamp(float(1).sub(exp(this.sunPosition.y.div(45e4))),0,1));varyingProperty("float","vSunfade").assign(u);const d=this.rayleigh.sub(float(1).mul(float(1).sub(u)));varyingProperty("vec3","vBetaR").assign(t.mul(d));const c=float(.2).mul(this.turbidity).mul(1e-17),f=float(.434).mul(c).mul(e);varyingProperty("vec3","vBetaM").assign(f.mul(this.mieCoefficient));const v=modelViewProjection();return v.z.assign(v.w),v}))(),e=Fn((()=>{const o=varying(vec3(),"vSunDirection"),t=varying(float(),"vSunE"),e=varying(float(),"vSunfade"),i=varying(vec3(),"vBetaR"),a=varying(vec3(),"vBetaM"),s=float(3.141592653589793),l=float(8400),n=float(1250),r=float(.9999566769464484),m=float(.05968310365946075),u=float(.07957747154594767),d=normalize(positionWorld.sub(cameraPosition)),c=acos(max(0,dot(this.upUniform,d))),f=float(1).div(cos(c).add(float(.15).mul(pow(float(93.885).sub(c.mul(180).div(s)),-1.253)))),v=l.mul(f),p=n.mul(f),h=exp(mul(i,v).add(mul(a,p)).negate()),y=dot(d,o),g=y.mul(.5).add(.5),w=m.mul(float(1).add(pow(g,2))),b=i.mul(w),x=pow(this.mieDirectionalG,2),P=float(1).div(pow(float(1).sub(float(2).mul(this.mieDirectionalG).mul(y)).add(x),1.5)),S=u.mul(float(1).sub(x)).mul(P),B=a.mul(S),M=pow(t.mul(add(b,B).div(add(i,a))).mul(sub(1,h)),vec3(1.5));M.mulAssign(mix(vec3(1),pow(t.mul(add(b,B).div(add(i,a))).mul(h),vec3(.5)),clamp(pow(sub(1,dot(this.upUniform,o)),5),0,1)));const k=vec3(.1).mul(h),D=smoothstep(r,r.add(2e-5),y);k.addAssign(t.mul(19e3).mul(h).mul(D));const G=add(M,k).mul(.04).add(vec3(0,3e-4,75e-5)),V=pow(G,vec3(float(1).div(float(1.2).add(e.mul(1.2)))));return vec4(V,1)}))();o.side=BackSide,o.depthWrite=!1,o.vertexNode=t,o.fragmentNode=e}}export{SkyMesh};
//# sourceMappingURL=/sm/a117e207bcb3865a9e32f7429c2d6ba1e80cdfd06a8dc93a49e961e1fbea7eba.map