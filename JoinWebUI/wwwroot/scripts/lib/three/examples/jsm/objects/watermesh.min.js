/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.170.0/examples/jsm/objects/WaterMesh.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Color,Mesh,Vector3}from"three";import{Fn,NodeMaterial,add,cameraPosition,div,normalize,positionWorld,sub,time,texture,vec2,vec3,vec4,max,dot,reflect,pow,length,float,uniform,reflector,mul,mix}from"three/tsl";class WaterMesh extends Mesh{constructor(o,t){const i=new NodeMaterial;super(o,i),this.isWater=!0,this.resolution=void 0!==t.resolution?t.resolution:.5,this.waterNormals=texture(t.waterNormals),this.alpha=uniform(void 0!==t.alpha?t.alpha:1),this.size=uniform(void 0!==t.size?t.size:1),this.sunColor=uniform(new Color(void 0!==t.sunColor?t.sunColor:16777215)),this.sunDirection=uniform(void 0!==t.sunDirection?t.sunDirection:new Vector3(.70707,.70707,0)),this.waterColor=uniform(new Color(void 0!==t.waterColor?t.waterColor:8355711)),this.distortionScale=uniform(void 0!==t.distortionScale?t.distortionScale:20);const r=Fn((([o])=>{const t=time,i=add(div(o,103),vec2(div(t,17),div(t,29))).toVar(),r=div(o,107).sub(vec2(div(t,-19),div(t,31))).toVar(),e=add(div(o,vec2(8907,9803)),vec2(div(t,101),div(t,97))).toVar(),s=sub(div(o,vec2(1091,1027)),vec2(div(t,109),div(t,-113))).toVar(),a=this.waterNormals.uv(i),l=this.waterNormals.uv(r),d=this.waterNormals.uv(e),n=this.waterNormals.uv(s);return a.add(l).add(d).add(n).mul(.5).sub(1)})),e=Fn((()=>{const o=r(positionWorld.xz.mul(this.size)),t=normalize(o.xzy.mul(1.5,1,1.5)),i=vec3(0).toVar(),e=vec3(0).toVar(),s=cameraPosition.sub(positionWorld),a=normalize(s),l=normalize(reflect(this.sunDirection.negate(),t)),d=max(0,dot(a,l));e.addAssign(pow(d,100).mul(this.sunColor).mul(2)),i.addAssign(max(dot(this.sunDirection,t),0).mul(this.sunColor).mul(.5));const n=length(s),u=t.xz.mul(float(.001).add(float(1).div(n))).mul(this.distortionScale),m=reflector();m.uvNode=m.uvNode.add(u),m.resolution=this.resolution,this.add(m.target);const v=max(dot(a,t),0),c=float(.3),h=mul(pow(float(1).sub(v),5),float(1).sub(c)).add(c),f=max(0,dot(t,a)).mul(this.waterColor),w=mix(this.sunColor.mul(i).mul(.3).add(f),m.rgb.mul(e).add(m.rgb.mul(.9)).add(vec3(.1)),h);return vec4(w,this.alpha)}))();i.fragmentNode=e}}export{WaterMesh};
//# sourceMappingURL=/sm/8d703c1673f9e70ce624b76c6228929c25f55686342d09c88f80448b726c9512.map