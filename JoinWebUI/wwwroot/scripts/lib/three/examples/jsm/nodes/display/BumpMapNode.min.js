/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.160.1/examples/jsm/nodes/display/BumpMapNode.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import TempNode from"../core/TempNode.js";import{addNodeClass}from"../core/Node.js";import{uv}from"../accessors/UVNode.js";import{normalView}from"../accessors/NormalNode.js";import{positionView}from"../accessors/PositionNode.js";import{faceDirection}from"./FrontFacingNode.js";import{addNodeElement,tslFn,nodeProxy,float,vec2}from"../shadernode/ShaderNode.js";const dHdxy_fwd=tslFn((({textureNode:e,bumpScale:o})=>{let r=e;if(!0!==r.isTextureNode&&r.traverse((e=>{!0===e.isTextureNode&&(r=e)})),!0!==r.isTextureNode)throw new Error("THREE.TSL: dHdxy_fwd() requires a TextureNode.");const d=float(e),s=r.uvNode||uv(),t=o=>e.cache().context({getUV:()=>o,forceUVContext:!0});return vec2(float(t(s.add(s.dFdx()))).sub(d),float(t(s.add(s.dFdy()))).sub(d)).mul(o)})),perturbNormalArb=tslFn((e=>{const{surf_pos:o,surf_norm:r,dHdxy:d}=e,s=o.dFdx().normalize(),t=r,a=o.dFdy().normalize().cross(t),u=t.cross(s),m=s.dot(a).mul(faceDirection),n=m.sign().mul(d.x.mul(a).add(d.y.mul(u)));return m.abs().mul(r).sub(n).normalize()}));class BumpMapNode extends TempNode{constructor(e,o=null){super("vec3"),this.textureNode=e,this.scaleNode=o}setup(){const e=null!==this.scaleNode?this.scaleNode:1,o=dHdxy_fwd({textureNode:this.textureNode,bumpScale:e});return perturbNormalArb({surf_pos:positionView,surf_norm:normalView,dHdxy:o})}}export default BumpMapNode;export const bumpMap=nodeProxy(BumpMapNode);addNodeElement("bumpMap",bumpMap),addNodeClass("BumpMapNode",BumpMapNode);
//# sourceMappingURL=/sm/78d5952a191b18f7751dd854826774716333128691c93ff83b432d140c0420a7.map