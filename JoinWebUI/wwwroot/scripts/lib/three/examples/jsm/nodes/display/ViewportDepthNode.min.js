/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.160.1/examples/jsm/nodes/display/ViewportDepthNode.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Node,{addNodeClass}from"../core/Node.js";import{nodeImmutable,nodeProxy}from"../shadernode/ShaderNode.js";import{cameraNear,cameraFar}from"../accessors/CameraNode.js";import{positionView}from"../accessors/PositionNode.js";import{viewportDepthTexture}from"./ViewportDepthTextureNode.js";class ViewportDepthNode extends Node{constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===ViewportDepthNode.DEPTH_PIXEL?e.getFragDepth():super.generate(e)}setup(){const{scope:e}=this;let t=null;if(e===ViewportDepthNode.DEPTH)t=viewZToOrthographicDepth(positionView.z,cameraNear,cameraFar);else if(e===ViewportDepthNode.DEPTH_TEXTURE){const e=this.valueNode||viewportDepthTexture(),o=perspectiveDepthToViewZ(e,cameraNear,cameraFar);t=viewZToOrthographicDepth(o,cameraNear,cameraFar)}else e===ViewportDepthNode.DEPTH_PIXEL&&null!==this.valueNode&&(t=depthPixelBase().assign(this.valueNode));return t}}export const viewZToOrthographicDepth=(e,t,o)=>e.add(t).div(t.sub(o));export const orthographicDepthToViewZ=(e,t,o)=>t.sub(o).mul(e).sub(t);export const viewZToPerspectiveDepth=(e,t,o)=>t.add(e).mul(o).div(t.sub(o).mul(e));export const perspectiveDepthToViewZ=(e,t,o)=>t.mul(o).div(o.sub(t).mul(e).sub(o));ViewportDepthNode.DEPTH="depth",ViewportDepthNode.DEPTH_TEXTURE="depthTexture",ViewportDepthNode.DEPTH_PIXEL="depthPixel";export default ViewportDepthNode;const depthPixelBase=nodeProxy(ViewportDepthNode,ViewportDepthNode.DEPTH_PIXEL);export const depth=nodeImmutable(ViewportDepthNode,ViewportDepthNode.DEPTH);export const depthTexture=nodeProxy(ViewportDepthNode,ViewportDepthNode.DEPTH_TEXTURE);export const depthPixel=nodeImmutable(ViewportDepthNode,ViewportDepthNode.DEPTH_PIXEL);depthPixel.assign=e=>depthPixelBase(e),addNodeClass("ViewportDepthNode",ViewportDepthNode);
//# sourceMappingURL=/sm/7973bbe2f2217a9208eaca18f3369926e26aae89781c8bb62725306c51e3f1a6.map