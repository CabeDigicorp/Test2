/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.160.1/examples/jsm/nodes/accessors/SkinningNode.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Node,{addNodeClass}from"../core/Node.js";import{NodeUpdateType}from"../core/constants.js";import{nodeProxy}from"../shadernode/ShaderNode.js";import{attribute}from"../core/AttributeNode.js";import{uniform}from"../core/UniformNode.js";import{add}from"../math/OperatorNode.js";import{buffer}from"./BufferNode.js";import{normalLocal}from"./NormalNode.js";import{positionLocal}from"./PositionNode.js";import{tangentLocal}from"./TangentNode.js";class SkinningNode extends Node{constructor(e){super("void"),this.skinnedMesh=e,this.updateType=NodeUpdateType.OBJECT,this.skinIndexNode=attribute("skinIndex","uvec4"),this.skinWeightNode=attribute("skinWeight","vec4"),this.bindMatrixNode=uniform(e.bindMatrix,"mat4"),this.bindMatrixInverseNode=uniform(e.bindMatrixInverse,"mat4"),this.boneMatricesNode=buffer(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length)}setup(e){const{skinIndexNode:o,skinWeightNode:t,bindMatrixNode:n,bindMatrixInverseNode:i,boneMatricesNode:r}=this,s=r.element(o.x),d=r.element(o.y),a=r.element(o.z),m=r.element(o.w),l=n.mul(positionLocal),u=add(s.mul(t.x).mul(l),d.mul(t.y).mul(l),a.mul(t.z).mul(l),m.mul(t.w).mul(l)),N=i.mul(u).xyz;let p=add(t.x.mul(s),t.y.mul(d),t.z.mul(a),t.w.mul(m));p=i.mul(p).mul(n);const c=p.transformDirection(normalLocal).xyz;positionLocal.assign(N),normalLocal.assign(c),e.hasGeometryAttribute("tangent")&&tangentLocal.assign(c)}generate(e,o){if("void"!==o)return positionLocal.build(e,o)}update(){this.skinnedMesh.skeleton.update()}}export default SkinningNode;export const skinning=nodeProxy(SkinningNode);addNodeClass("SkinningNode",SkinningNode);
//# sourceMappingURL=/sm/8ae1806eb8ff1890efa796e982093404a522170f39d1be276cbe6c94f478d792.map