/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/three@0.160.1/examples/jsm/renderers/common/Bindings.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import DataMap from"./DataMap.js";import{AttributeType}from"./Constants.js";class Bindings extends DataMap{constructor(t,e,i,s,n,r){super(),this.backend=t,this.textures=i,this.pipelines=n,this.attributes=s,this.nodes=e,this.info=r,this.pipelines.bindings=this}getForRender(t){const e=t.getBindings(),i=this.get(t);return i.bindings!==e&&(i.bindings=e,this._init(e),this.backend.createBindings(e)),i.bindings}getForCompute(t){const e=this.get(t);if(void 0===e.bindings){const i=this.nodes.getForCompute(t).bindings.compute;e.bindings=i,this._init(i),this.backend.createBindings(i)}return e.bindings}updateForCompute(t){this._update(t,this.getForCompute(t))}updateForRender(t){this._update(t,this.getForRender(t))}_init(t){for(const e of t)if(e.isSampledTexture)this.textures.updateTexture(e.texture);else if(e.isStorageBuffer){const t=e.attribute;this.attributes.update(t,AttributeType.STORAGE)}}_update(t,e){const{backend:i}=this;let s=!1;for(const t of e){if(t.isNodeUniformsGroup){if(!this.nodes.updateGroup(t))continue}if(t.isUniformBuffer){t.update()&&i.updateBinding(t)}else if(t.isSampledTexture){const e=t.texture;t.needsBindingsUpdate&&(s=!0);if(t.update()&&this.textures.updateTexture(t.texture),!0===e.isStorageTexture){const i=this.get(e);!0===t.store?i.needsMipmap=!0:!0===e.generateMipmaps&&this.textures.needsMipmaps(e)&&!0===i.needsMipmap&&(this.backend.generateMipmaps(e),i.needsMipmap=!1)}}}if(!0===s){const i=this.pipelines.getForRender(t);this.backend.updateBindings(e,i)}}}export default Bindings;
//# sourceMappingURL=/sm/a62d7cc4e31e2ca929bf10176eed9f8f6ee829f5e66902dd84a5d038972120d4.map